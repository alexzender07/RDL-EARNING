<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDL EARN</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* General Body and Dark Theme */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #f0f0f0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Container for the main app content */
        .container {
            flex-grow: 1;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 15px;
            box-sizing: border-box;
        }

        /* Header Styling */
        header {
            background-color: #2a2a2a;
            padding: 15px 0;
            text-align: center;
            border-bottom: 1px solid #333;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        header h1 {
            margin: 0;
            font-size: 1.8em;
            color: #00bcd4; /* Accent color for the title */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        header h1 img {
            height: 40px;
            margin-right: 10px;
        }

        /* Navigation Tabs */
        .tabs {
            display: flex;
            justify-content: space-around;
            background-color: #2a2a2a;
            padding: 10px 0;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 70px; /* Below the header */
            z-index: 999;
        }

        .tab-button {
            background: none;
            border: none;
            color: #f0f0f0;
            padding: 10px 15px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            flex: 1;
            text-align: center;
            border-radius: 5px;
            margin: 0 5px;
        }

        .tab-button:hover {
            background-color: #3a3a3a;
        }

        .tab-button.active {
            background-color: #00bcd4;
            color: #1a1a1a;
            font-weight: bold;
        }

        /* Section Styling */
        .section {
            display: none;
            padding: 20px 0;
            background-color: #242424;
            margin-top: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .section.active {
            display: block;
        }

        .section h2 {
            color: #00bcd4;
            text-align: center;
            margin-top: 0;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        /* Card-like elements for better UI */
        .card {
            background-color: #333;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }

        .card h3 {
            color: #f0f0f0;
            margin-top: 0;
            margin-bottom: 10px;
        }

        .card p {
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .card button {
            background-color: #00bcd4;
            color: #1a1a1a;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            margin-top: 10px;
        }

        .card button:hover {
            background-color: #0097a7;
        }

        .card input[type="text"],
        .card input[type="number"],
        .card textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-top: 5px;
            margin-bottom: 10px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #444;
            color: #f0f0f0;
            box-sizing: border-box;
        }

        .card label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
        }

        /* Specific styles for "One Time Tap & Earn" */
        #tap-earn-section .card {
            text-align: center;
        }

        #rdl-logo-tap {
            width: 120px;
            height: 120px;
            background-color: #00bcd4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #1a1a1a;
            margin: 20px auto;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 188, 212, 0.7);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        #rdl-logo-tap:active {
            transform: scale(0.95);
            box-shadow: 0 0 5px rgba(0, 188, 212, 0.7);
        }

        #tap-earn-section p {
            font-size: 1.1em;
            margin-top: 10px;
        }

        #tap-earn-section .level-info,
        #tap-earn-section .coins-info {
            font-size: 1.2em;
            margin-bottom: 10px;
            display: block;
        }

        /* Profile Section */
        #profile-section .profile-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        #profile-pic {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
            border: 3px solid #00bcd4;
            box-shadow: 0 0 8px rgba(0, 188, 212, 0.5);
        }

        #profile-details p {
            margin: 5px 0;
            font-size: 1.1em;
        }

        #profile-details strong {
            color: #00bcd4;
        }
        
        /* Task section */
        .task-item {
            display: flex;
            flex-direction: column;
            background-color: #3a3a3a;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .task-item h4 {
            color: #00bcd4;
            margin-top: 0;
            margin-bottom: 5px;
            font-size: 1.2em;
        }
        .task-item p {
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .task-item .reward-btn {
            background-color: #4CAF50; /* Green for tasks */
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: fit-content;
        }
        .task-item .reward-btn:hover {
            background-color: #45a049;
        }
        .task-item .watch-ad-btn {
            background-color: #FF9800; /* Orange for ads */
        }
        .task-item .watch-ad-btn:hover {
            background-color: #fb8c00;
        }

        /* Withdrawal Section */
        #withdrawal-section .withdrawal-request-item {
            background-color: #3a3a3a;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }

        .withdrawal-request-item .status-pending { color: #FFC107; } /* Amber */
        .withdrawal-request-item .status-approved { color: #4CAF50; } /* Green */
        .withdrawal-request-item .status-rejected { color: #F44336; } /* Red */
        
        /* Referral Section */
        #referral-section .card {
            text-align: center;
        }
        #referral-link-display {
            background-color: #444;
            padding: 10px;
            border-radius: 5px;
            word-break: break-all;
            margin-top: 10px;
            margin-bottom: 15px;
            border: 1px dashed #00bcd4;
            font-family: 'Courier New', Courier, monospace;
        }
        #copy-referral-btn {
            background-color: #2196F3; /* Blue for copy */
            margin-top: 5px;
        }
        #copy-referral-btn:hover {
            background-color: #1976D2;
        }


        /* Admin Panel specific styles */
        #admin-panel {
            background-color: #1c1c1c;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
        }
        #admin-panel h2 {
            color: #FFEB3B; /* Yellow for admin section */
        }
        #admin-panel label {
            margin-top: 10px;
            margin-bottom: 5px;
            display: block;
            color: #eee;
        }
        #admin-panel input[type="text"],
        #admin-panel input[type="number"],
        #admin-panel textarea,
        #admin-panel select {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #666;
            border-radius: 5px;
            background-color: #333;
            color: #f0f0f0;
        }
        #admin-panel button {
            background-color: #FFEB3B;
            color: #1a1a1a;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            margin-right: 10px;
        }
        #admin-panel button:hover {
            background-color: #fdd835;
        }

        .admin-section-card {
            background-color: #333;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .admin-section-card h3 {
            color: #FFEB3B;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .admin-list-item {
            background-color: #444;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .admin-list-item button {
            margin-left: 10px;
            padding: 8px 12px;
            font-size: 0.9em;
            border-radius: 4px;
        }
        .admin-list-item .delete-btn {
            background-color: #F44336;
            color: white;
        }
        .admin-list-item .delete-btn:hover {
            background-color: #d32f2f;
        }
        .admin-list-item .edit-btn {
             background-color: #2196F3;
             color: white;
        }
        .admin-list-item .edit-btn:hover {
            background-color: #1976D2;
        }
        .admin-list-item .approve-btn {
            background-color: #4CAF50;
            color: white;
        }
        .admin-list-item .approve-btn:hover {
            background-color: #45a049;
        }
        .admin-list-item .reject-btn {
            background-color: #FF9800;
            color: white;
        }
        .admin-list-item .reject-btn:hover {
            background-color: #fb8c00;
        }

        /* Utility classes */
        .text-center { text-align: center; }
        .mt-15 { margin-top: 15px; }
        .mb-15 { margin-bottom: 15px; }

        /* Responsive Adjustments */
        @media (max-width: 480px) {
            .tabs {
                flex-wrap: wrap;
                top: 60px; /* Adjust if header height changes */
            }
            .tab-button {
                flex: 1 1 45%; /* Allow two buttons per row */
                margin: 5px;
                font-size: 0.9em;
            }
            header h1 {
                font-size: 1.5em;
            }
            header h1 img {
                height: 30px;
            }
            .section {
                padding: 15px 10px;
            }
            .card {
                padding: 10px;
            }
            #rdl-logo-tap {
                width: 100px;
                height: 100px;
                font-size: 2em;
            }
        }
    </style>
</head>
<body>

    <!-- Main Header -->
    <header>
        <h1><img src="https://i.imgur.com/your-logo-here.png" alt="RDL EARN Logo"> RDL EARN</h1>
    </header>

    <!-- Navigation Tabs -->
    <nav class="tabs" id="main-tabs">
        <button class="tab-button active" data-tab="tap-earn-section">Tap & Earn üí∞</button>
        <button class="tab-button" data-tab="tasks-section">Tasks ‚úÖ</button>
        <button class="tab-button" data-tab="withdrawal-section">Withdraw üí∏</button>
        <button class="tab-button" data-tab="profile-section">Profile üë§</button>
        <button class="tab-button" data-tab="referral-section">Refer & Earn ü§ù</button>
    </nav>

    <!-- Main Content Container -->
    <div class="container">

        <!-- 1. One Time Tap & Earn Section -->
        <section id="tap-earn-section" class="section active">
            <h2>Tap & Earn Daily! üöÄ</h2>
            <div class="card text-center">
                <div id="rdl-logo-tap">RDL</div>
                <p id="tap-earn-message">Tap the RDL logo to earn 1000 coins!</p>
                <p class="coins-info">Your Coins: <strong id="user-coins-display">0</strong> ü™ô</p>
                <p class="level-info">Your Level: <strong id="user-level-display">1</strong> üåü</p>
                <p id="next-tap-time">Next tap available in: --:--:--</p>
            </div>
        </section>

        <!-- 2. Tasks Section -->
        <section id="tasks-section" class="section">
            <h2>Complete Tasks & Earn More! üí™</h2>
            <div id="tasks-list">
                <!-- Watch Ad Task (Fixed) -->
                <div class="task-item">
                    <h4>Watch a Rewarded Ad! üì∫</h4>
                    <p>Watch a short video ad and earn <strong id="ad-reward-coins">500</strong> coins!</p>
                    <button class="reward-btn watch-ad-btn" onclick="showRewardedAd()">Watch Ad</button>
                </div>
                <!-- Dynamic tasks will be loaded here from Firebase -->
                <p class="text-center" id="no-tasks-message">No tasks available right now. Check back later! üòâ</p>
            </div>
        </section>

        <!-- 3. Withdrawal Section -->
        <section id="withdrawal-section" class="section">
            <h2>Withdraw Your Earnings üí∞</h2>
            <div class="card">
                <h3>Exchange Coins for USDT</h3>
                <p>Current Rate: 10,000 Coins = <strong id="usdt-conversion-rate">1</strong> USDT</p>
                <p>Your current coins: <strong id="withdrawal-user-coins">0</strong> ü™ô</p>
                <label for="usdt-amount-input">USDT Amount (min <span id="min-usdt-withdraw">1</span>):</label>
                <input type="number" id="usdt-amount-input" placeholder="Enter USDT amount (e.g., 1.0)" min="1" step="0.1">
                <label for="usdt-wallet-address">USDT TRC20 Wallet Address:</label>
                <input type="text" id="usdt-wallet-address" placeholder="Enter your USDT TRC20 wallet address">
                <button onclick="requestWithdrawal()">Request Withdrawal</button>
                <p id="withdrawal-message" style="margin-top: 10px; color: #FFEB3B;"></p>
            </div>

            <h3 class="mt-15 text-center">Your Withdrawal History</h3>
            <div id="withdrawal-history">
                <!-- User's withdrawal requests will be loaded here -->
                <p class="text-center" id="no-withdrawals-message">No withdrawal requests yet.</p>
            </div>
        </section>

        <!-- 4. Profile Section -->
        <section id="profile-section" class="section">
            <h2>Your Profile üë§</h2>
            <div class="card">
                <div class="profile-header">
                    <img id="profile-pic" src="https://via.placeholder.com/80?text=üë§" alt="Profile Picture">
                    <div id="profile-details">
                        <p>Hello, <strong id="profile-username">Guest</strong>!</p>
                        <p>Telegram ID: <strong id="profile-telegram-id">N/A</strong></p>
                    </div>
                </div>
                <hr style="border-color: #444; margin: 15px 0;">
                <p>Total Coins: <strong id="profile-coins">0</strong> ü™ô</p>
                <p>Current Level: <strong id="profile-level">1</strong> üåü</p>
                <p>Referrals: <strong id="profile-referrals">0</strong> üë•</p>
            </div>
        </section>

        <!-- 5. Referral Section -->
        <section id="referral-section" class="section">
            <h2>Refer & Earn! ü§ù</h2>
            <div class="card text-center">
                <h3>Invite Friends, Get Coins!</h3>
                <p>Share your unique referral link with friends. When they join and start earning, you'll get <strong id="referral-points-display">500</strong> coins per referral! üéâ</p>
                <p>Your Referral Link:</p>
                <div id="referral-link-display">Loading...</div>
                <button id="copy-referral-btn" onclick="copyReferralLink()">Copy Link</button>
                <p id="copy-status" style="margin-top: 10px; color: #4CAF50;"></p>
            </div>
        </section>

        <!-- Admin Panel (Hidden by default, shown based on URL parameter) -->
        <section id="admin-panel" class="section" style="display: none;">
            <h2>Admin Dashboard ‚öôÔ∏è</h2>

            <!-- Admin Dashboard Overview -->
            <div class="admin-section-card">
                <h3>Overview</h3>
                <p>Total Users: <strong id="admin-total-users">0</strong></p>
                <p>Total Coins in circulation: <strong id="admin-total-coins-in-circulation">0</strong></p>
                <label for="admin-usdt-rate">USDT Conversion Rate (Coins per 1 USDT):</label>
                <input type="number" id="admin-usdt-rate" value="10000" min="100" step="100">
                <label for="admin-ad-reward">Ad Watch Reward (Coins):</label>
                <input type="number" id="admin-ad-reward" value="500" min="10" step="10">
                <label for="admin-referral-reward">Referral Reward (Coins):</label>
                <input type="number" id="admin-referral-reward" value="500" min="10" step="10">
                <label for="admin-min-usdt-withdraw">Minimum USDT Withdrawal Amount:</label>
                <input type="number" id="admin-min-usdt-withdraw" value="1" min="0.1" step="0.1">
                <button onclick="saveAdminSettings()">Save Settings</button>
            </div>

            <!-- Admin Task Management -->
            <div class="admin-section-card">
                <h3>Task Management</h3>
                <label for="task-name">Task Name:</label>
                <input type="text" id="task-name" placeholder="e.g., Join our Telegram Channel">
                <label for="task-description">Description:</label>
                <textarea id="task-description" placeholder="e.g., Join our official Telegram channel to stay updated!"></textarea>
                <label for="task-reward">Reward (Coins):</label>
                <input type="number" id="task-reward" placeholder="e.g., 2000">
                <label for="task-link">Task Link (for channel/website):</label>
                <input type="text" id="task-link" placeholder="e.g., https://t.me/your_channel">
                <label for="task-type">Task Type:</label>
                <select id="task-type">
                    <option value="general">General (Click to Claim)</option>
                    <option value="telegram_join">Telegram Channel Join</option>
                </select>
                <button onclick="addTask()">Add Task</button>
                <div id="current-tasks-list" class="mt-15">
                    <h4>Current Tasks:</h4>
                    <!-- Admin tasks will be loaded here -->
                </div>
            </div>

            <!-- Admin Withdrawal Requests -->
            <div class="admin-section-card">
                <h3>Withdrawal Requests</h3>
                <div id="admin-withdrawal-requests">
                    <!-- Admin withdrawal requests will be loaded here -->
                </div>
            </div>
        </section>

    </div> <!-- End .container -->

    <!-- Monotag Ads SDK (Place at the end of body for best performance) -->
    <script src='//libtl.com/sdk.js' data-zone='9935313' data-sdk='show_9935313'></script>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // --- Global Variables ---
        let telegramUser = null;
        let userData = {
            id: null,
            username: 'Guest',
            photo_url: 'https://via.placeholder.com/80?text=üë§',
            coins: 0,
            level: 1,
            lastTapTime: 0,
            referralCode: '',
            referredBy: '',
            referralsCount: 0,
            completedTasks: [] // Array of task IDs
        };
        let appSettings = {
            usdtConversionRate: 10000, // coins per 1 USDT
            adRewardCoins: 500,
            referralRewardCoins: 500,
            minUsdtWithdraw: 1
        };
        let tasks = []; // Store fetched tasks

        const USERS_COLLECTION = 'users';
        const TASKS_COLLECTION = 'tasks';
        const WITHDRAWALS_COLLECTION = 'withdrawals';
        const SETTINGS_DOC = 'app_settings'; // Document for global settings

        // --- Telegram WebApp Integration ---
        if (window.Telegram && window.Telegram.WebApp) {
            telegramUser = window.Telegram.WebApp.initDataUnsafe.user;
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand(); // Expand the web app to full screen
            console.log("Telegram WebApp Initialized:", telegramUser);
        } else {
            console.warn("Telegram WebApp SDK not found or not in Telegram environment.");
            // For testing outside Telegram, create a dummy user
            telegramUser = {
                id: '123456789',
                first_name: 'Test',
                last_name: 'User',
                username: 'testuser',
                photo_url: 'https://via.placeholder.com/80?text=üß™'
            };
        }

        // --- Firebase User Authentication/Loading ---
        async function loadUserData() {
            if (!telegramUser || !telegramUser.id) {
                console.error("Telegram User ID not available.");
                updateUI();
                return;
            }

            userData.id = telegramUser.id.toString();
            userData.username = telegramUser.username || telegramUser.first_name || 'User';
            userData.photo_url = telegramUser.photo_url || 'https://via.placeholder.com/80?text=üë§';
            userData.referralCode = generateReferralCode(userData.id);

            // Check for referral in URL
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode && refCode !== userData.referralCode) {
                userData.referredBy = refCode;
                console.log("User referred by:", refCode);
            }

            try {
                // Fetch user data from Firestore
                const userDoc = await db.collection(USERS_COLLECTION).doc(userData.id).get();

                if (userDoc.exists) {
                    userData = { ...userData, ...userDoc.data() };
                    console.log("User data loaded from Firebase:", userData);

                    // If referredBy exists in URL and not yet processed in DB
                    if (refCode && refCode !== userData.referralCode && !userDoc.data().referredBy) {
                         userData.referredBy = refCode; // Store the referrer
                         await db.collection(USERS_COLLECTION).doc(userData.id).update({
                            referredBy: refCode
                         });
                         // Award referrer
                         await awardReferral(refCode, userData.id);
                    }

                } else {
                    // New user: Save initial data to Firestore
                    console.log("New user, saving to Firebase...");
                    await db.collection(USERS_COLLECTION).doc(userData.id).set(userData);
                    console.log("New user data saved:", userData);

                    // If referred, award referrer upon first creation
                    if (userData.referredBy) {
                        await awardReferral(userData.referredBy, userData.id);
                    }
                }

                 // Load app settings
                await loadAppSettings();
                // Load tasks
                await loadTasks();

                // Update UI after loading data
                updateUI();
                startTapCountdown();

            } catch (error) {
                console.error("Error loading user data or settings:", error);
                alert("Error loading data. Please try again later.");
            }
        }

        // --- Firebase App Settings ---
        async function loadAppSettings() {
            try {
                const settingsDoc = await db.collection('settings').doc(SETTINGS_DOC).get();
                if (settingsDoc.exists) {
                    appSettings = { ...appSettings, ...settingsDoc.data() };
                    console.log("App settings loaded:", appSettings);
                } else {
                    // Create default settings if not exists
                    await db.collection('settings').doc(SETTINGS_DOC).set(appSettings);
                }
                updateSettingsUI();
            } catch (error) {
                console.error("Error loading app settings:", error);
            }
        }

        function updateSettingsUI() {
            document.getElementById('usdt-conversion-rate').textContent = appSettings.usdtConversionRate;
            document.getElementById('ad-reward-coins').textContent = appSettings.adRewardCoins;
            document.getElementById('referral-points-display').textContent = appSettings.referralRewardCoins;
            document.getElementById('min-usdt-withdraw').textContent = appSettings.minUsdtWithdraw;

            // Admin Panel updates
            if (isAdminMode) {
                document.getElementById('admin-usdt-rate').value = appSettings.usdtConversionRate;
                document.getElementById('admin-ad-reward').value = appSettings.adRewardCoins;
                document.getElementById('admin-referral-reward').value = appSettings.referralRewardCoins;
                document.getElementById('admin-min-usdt-withdraw').value = appSettings.minUsdtWithdraw;
            }
        }

        async function saveAdminSettings() {
            if (!isAdminMode) return;
            const newUsdtRate = parseFloat(document.getElementById('admin-usdt-rate').value);
            const newAdReward = parseInt(document.getElementById('admin-ad-reward').value);
            const newReferralReward = parseInt(document.getElementById('admin-referral-reward').value);
            const newMinUsdtWithdraw = parseFloat(document.getElementById('admin-min-usdt-withdraw').value);

            if (isNaN(newUsdtRate) || isNaN(newAdReward) || isNaN(newReferralReward) || isNaN(newMinUsdtWithdraw)) {
                alert('Please enter valid numbers for all settings.');
                return;
            }

            appSettings.usdtConversionRate = newUsdtRate;
            appSettings.ad
